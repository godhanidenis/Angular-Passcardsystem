<div class="row">
  <div class="col-lg-12">
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">App connections</h3>
      </div>
      <!-- /.card-header -->
      <div class="card-body">
        <table class="table table-bordered">
          <thead>
            <tr>
              <th>Name</th>
              <th>People</th>
              <th>Vehicle Number</th>
              <th>Contact</th>
              <th>Location</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><input ng-model="searchtxt.name" type="text" class="form-control" placeholder="Filter"></td>
              <td></td>
              <td><input ng-model="searchtxt.vehicle_number" type="text" class="form-control" placeholder="Filter"></td>
              <td><input ng-model="searchtxt.phone" type="text" class="form-control" placeholder="Filter"></td>
              <td><input ng-model="searchtxt.res_area.area_name" type="text" class="form-control" placeholder="Filter">
              </td>
              <td><input ng-model="searchtxt.status" type="text" class="form-control" placeholder="Filter"></td>
              <!-- <td><button ng-click="searchtxt = null" type="button" class="btn btn-block btn-primary btn-xs">Reset</button></td> -->
            </tr>







            <tr ng-if="con.status == 'PENDING' && isAdmin == true"
              ng-repeat="con in connections | filter : searchtxt | limitTo: limit | orderBy: '-url'">
              <td><span style="font-weight: 900; text-transform: uppercase;">{{con.name}}</span><br><a
                  class="badge badge-primary" style="color: #fff;" ng-click="setConResToView(con)" data-toggle="modal"
                  data-target="#viewConModal">Edit</a><a class="badge badge-success"
                  style="color: #fff; margin-left: 5px;" ng-click="setConResToView(con)" data-toggle="modal"
                  data-target="#viewviewConModal">View</a></td>
              <td>{{con.number_of_resident}}</td>
              <td>{{con.vehicle_number}}</td>
              <td><a href="tel:{{con.phone}}">
                  <img
                    src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAABmJLR0QA/wD/AP+gvaeTAAACEElEQVQ4jdXUT0jTYRzH8fd3+21rPzF1lbr5h5LIDlG5/pibRF6CDhWIHqIIYpTUQehY1K3o5LHAEsOgQ1LQoa4pZNrEwoqkIBlMsPKgSbG1+m3fDu431l/cOkSf0/M834fX8/z4Pc8D/0skvxPo7TVxmnshfRAV00wuHn3T3Z0qFDXsRvOjZx2p5Mfzc7HpzfZaSW/5ONBTKOqwGyoacZeUbjJcnlxR0bP1V25WFI2KyoCoOlauXpNf91ku60zRqPfL/G0gZvpWqcuzIn9OsGh0uK3NUvScgFT4A1Z2+DXO9LFC0e/+PqrSPDY5DLL7w/vZVGL+bcNMJDJb9E6XlhDFoSeBRFmVX6o3BisLBX9Ggeiu4BRwWhC3Q+TetpGJ+r9GAaKhrVdVtQ+ocTmM+60Pnxd0rOR3hc7BQWe8dsMg0A5MWRlr35PW7XGAQH9/HZZzAGHC+Gpcip86vLAsFKBldNSbxrwlsB9lJoMeePfq6Vw6YzwAGrPT5kW56P28eNm+0r/8fDtjoVDSTC20q2ofQp0IUbOiOpYHAvhU6El4y27YA39EYen8joebjovqCUGs8uoad+XaBuuHCwKiiWWjdh6Hm67hyOxAGfGUlBpV6xvV568l91ao3M35y0VzUZWdY5OHBLkArAM0lfj0Ym76ZctsV1eiODSbPUNDRtLt60D0CCrXo+Etd4q1/l2+AaHDrRzfe0T4AAAAAElFTkSuQmCC" />
                  {{con.phone}}</a>
                <span style="display: inline-block; width: 10px;"></span>
                <a href="mailto:{{con.email}}">
                  <img
                    src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAABmJLR0QA/wD/AP+gvaeTAAAE7ElEQVQ4jZ1Ua0xTZxh+ek57SqEXKG0p91JQLgoK6iZscSwzczpjgqaaTCduOmecLkgGm5vZTqK7amYc4oQwdcZlGZg53X5sioLAAAeC4AW5KFAQSlsuvZwe25727MfUVUWX7P35vM/zfO/7vd/7CfCUWFF8WpaUHJUnlQapJZRI4fL4nSzDWkw25vcTOxaNPkknmA4sPNb2ki46fLtKJc2OigjTEMS/NJ7nYbbYHRaro804MlF563R3WVXVat8TTXPpGuHiDO2huRm6dSESSnKr39zpYNhmp9Mz7ON8rJAig4IoKlIqFWcl6tTzhUJS2HljqLqne+yd0m3P9jxW3ebNraIvf+37rfaOn//pyuTQrh86dxgMleSTWiw+enllRcNIW52J5482jV1/+3DzjMdIe37uKq8d8fM/Xrb2FR5pzwnMbdpbl7G9tGnl+s+qwwPx9Qerw0vODtTWmXj+0IWhJgNdSQGAEAAKyluWZs1JyLc77jo7uoaLvn4zsxEAio63L9PFqnbFRYUvkMrEQpPJbtFoWk8mz4zKGx2bqvvYkLZG8U3zOnloyLm0lOiFZuusj6qATwgA0OtUW6QhYqqvb+zMF+vmngKA94+1v5ozL/H79NSYbCfDWvv6zW3iIJJcME+/IXlmpFYmC7YDQMm7C4d7ekdLeZ5HdKRyFU3TBLGi+LRMpVJkuxg31907UgYABrqSSkyM+DQ8XKbquGa8cL6ufe5bz0XOq2/sXiogSAYAOJ/Pfv8aenpvlg8NW2/r4lSpVs2SJYQ+JWp5pFahvmOaullWkFMPAEn6Gfkz9BFzLOMOW3fXnYKKgsVjALB/04K/xiftLQDg8XAPTKvo1R6Xy3tdLBYSitCQVEIeItGSBAGPhxsABDwAqDXyLJIkYDROnDu4Pedq4HD8frAA4GK9tkDcc6/yIIlITogpkRwAvJzvAYkSUREAYLMx/Y++EpIkQgGAdXnsgbhISCoBwM1yDsLn87sBgCQEovsE3u8nAcAv4McDhQa6kgqiRPFerw+sx/1gTbd82xitDA3OdDjuei0m20WCcXpsAECQ/5wEAAzDjgNAqEySHGiq1yVtjI8PT+T9PMBx3vt4nFpZHKkN0/YbrfVlhc+3EqMj9vMTNoaVhohnG3ZUSgDAwbiv+P084uLVy4uOtL0AAAWHL2WnpcUUGI3jrIgSIixMngkAH5zo2JqeEZNvm2KZocHxr4B7u3/44nBTSlLUwvO114t2r03fl0vXBK3JTaqflRIzf2LCOWWdZAbUSqme43y+hubeMyuWZebb7OyEddw5Eh+nTOW8fu5Sa98ees3sPQBAAkDmy/myBJ3mFVJIxmrT8n45uXPRZEL22nrW5YnmOJ9SJBQET0wyN272mj5sGZzaJ/ZxakKACJIkpGazo/1q1zC9+7X00ocmmkvXCA/c2+GD1caabSUNUY9O/X/FtpJLCRUNo9fqTDx/pHHs6s7jHRsBftr/FgA2fF6jK/yuZdV0uYdEmw80xKUmR1dkzIpdDAD9g+ZOh9N9mXF5Bjkv5wIPjSRYpJCGSBK1EfJnxizOP7e+GL30qaYAQNM04dbnvREbq1yrUsqyIjRyhUDwMI3jfDBb7Lf7ByynduYlv/efpoHx+t4/NOow9XK5TKQUUyK5h/MzrNvrYOx3B91XyLPl5fO90+n+Bnj1JdCPjO1wAAAAAElFTkSuQmCC" />
                  {{con.email}}</a>
              </td>
              <td><span style="font-weight: 900; text-transform: uppercase;">{{con.res_area.area_name}}</span></td>
              <td><span ng-if="con.status == 'PENDING'" class="badge bg-primary">{{con.status}}</span>
                <span ng-if="con.status == 'APPROVED'" class="badge bg-success">{{con.status}}</span>
                <span ng-if="con.status == 'REJECTED'" class="badge bg-warning">{{con.status}}</span>
              </td>
              <td>
                <!-- ng-click="setConnectionStatus(con.url, 'approve', con.email, con.passcode, con.push_id, con)" -->
                <span ng-if="myAccessType.can_edit_connections">
                  <button ng-if="con.status == 'PENDING'" type="button" class="btn btn-block btn-primary btn-xs"
                   data-toggle="modal" data-target="#recurrConModal" ng-click="setCurrentConnection(con)">Approve</button>
                  <button ng-if="con.status == 'PENDING'" type="button" class="btn btn-block btn-warning btn-xs"
                    ng-click="setConnectionStatus(con.url, 'reject', con.email, con.passcode, con.push_id, con)">Reject</button>
                </span>
              </td>
            </tr>


            <tr ng-if="con.status == 'PENDING' && isAdmin == false && myUserArea == con.residence_area"
              ng-repeat="con in connections | filter : searchtxt | limitTo: limit | orderBy: '-url'">
              <td><span style="font-weight: 900; text-transform: uppercase;">{{con.name}}</span><br><a
                  class="badge badge-primary" style="color: #fff;" ng-click="setConResToView(con)" data-toggle="modal"
                  data-target="#viewConModal">Edit</a><a class="badge badge-success"
                  style="color: #fff; margin-left: 5px;" ng-click="setConResToView(con)" data-toggle="modal"
                  data-target="#viewviewConModal">View</a></td>
              <td>{{con.number_of_resident}}</td>
              <td>{{con.vehicle_number}}</td>
              <td><a href="tel:{{con.phone}}">
                  <img
                    src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAABmJLR0QA/wD/AP+gvaeTAAACEElEQVQ4jdXUT0jTYRzH8fd3+21rPzF1lbr5h5LIDlG5/pibRF6CDhWIHqIIYpTUQehY1K3o5LHAEsOgQ1LQoa4pZNrEwoqkIBlMsPKgSbG1+m3fDu431l/cOkSf0/M834fX8/z4Pc8D/0skvxPo7TVxmnshfRAV00wuHn3T3Z0qFDXsRvOjZx2p5Mfzc7HpzfZaSW/5ONBTKOqwGyoacZeUbjJcnlxR0bP1V25WFI2KyoCoOlauXpNf91ku60zRqPfL/G0gZvpWqcuzIn9OsGh0uK3NUvScgFT4A1Z2+DXO9LFC0e/+PqrSPDY5DLL7w/vZVGL+bcNMJDJb9E6XlhDFoSeBRFmVX6o3BisLBX9Ggeiu4BRwWhC3Q+TetpGJ+r9GAaKhrVdVtQ+ocTmM+60Pnxd0rOR3hc7BQWe8dsMg0A5MWRlr35PW7XGAQH9/HZZzAGHC+Gpcip86vLAsFKBldNSbxrwlsB9lJoMeePfq6Vw6YzwAGrPT5kW56P28eNm+0r/8fDtjoVDSTC20q2ofQp0IUbOiOpYHAvhU6El4y27YA39EYen8joebjovqCUGs8uoad+XaBuuHCwKiiWWjdh6Hm67hyOxAGfGUlBpV6xvV568l91ao3M35y0VzUZWdY5OHBLkArAM0lfj0Ym76ZctsV1eiODSbPUNDRtLt60D0CCrXo+Etd4q1/l2+AaHDrRzfe0T4AAAAAElFTkSuQmCC" />
                  {{con.phone}}</a>
                <span style="display: inline-block; width: 10px;"></span>
                <a href="mailto:{{con.email}}">
                  <img
                    src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAABmJLR0QA/wD/AP+gvaeTAAAE7ElEQVQ4jZ1Ua0xTZxh+ek57SqEXKG0p91JQLgoK6iZscSwzczpjgqaaTCduOmecLkgGm5vZTqK7amYc4oQwdcZlGZg53X5sioLAAAeC4AW5KFAQSlsuvZwe25727MfUVUWX7P35vM/zfO/7vd/7CfCUWFF8WpaUHJUnlQapJZRI4fL4nSzDWkw25vcTOxaNPkknmA4sPNb2ki46fLtKJc2OigjTEMS/NJ7nYbbYHRaro804MlF563R3WVXVat8TTXPpGuHiDO2huRm6dSESSnKr39zpYNhmp9Mz7ON8rJAig4IoKlIqFWcl6tTzhUJS2HljqLqne+yd0m3P9jxW3ebNraIvf+37rfaOn//pyuTQrh86dxgMleSTWiw+enllRcNIW52J5482jV1/+3DzjMdIe37uKq8d8fM/Xrb2FR5pzwnMbdpbl7G9tGnl+s+qwwPx9Qerw0vODtTWmXj+0IWhJgNdSQGAEAAKyluWZs1JyLc77jo7uoaLvn4zsxEAio63L9PFqnbFRYUvkMrEQpPJbtFoWk8mz4zKGx2bqvvYkLZG8U3zOnloyLm0lOiFZuusj6qATwgA0OtUW6QhYqqvb+zMF+vmngKA94+1v5ozL/H79NSYbCfDWvv6zW3iIJJcME+/IXlmpFYmC7YDQMm7C4d7ekdLeZ5HdKRyFU3TBLGi+LRMpVJkuxg31907UgYABrqSSkyM+DQ8XKbquGa8cL6ufe5bz0XOq2/sXiogSAYAOJ/Pfv8aenpvlg8NW2/r4lSpVs2SJYQ+JWp5pFahvmOaullWkFMPAEn6Gfkz9BFzLOMOW3fXnYKKgsVjALB/04K/xiftLQDg8XAPTKvo1R6Xy3tdLBYSitCQVEIeItGSBAGPhxsABDwAqDXyLJIkYDROnDu4Pedq4HD8frAA4GK9tkDcc6/yIIlITogpkRwAvJzvAYkSUREAYLMx/Y++EpIkQgGAdXnsgbhISCoBwM1yDsLn87sBgCQEovsE3u8nAcAv4McDhQa6kgqiRPFerw+sx/1gTbd82xitDA3OdDjuei0m20WCcXpsAECQ/5wEAAzDjgNAqEySHGiq1yVtjI8PT+T9PMBx3vt4nFpZHKkN0/YbrfVlhc+3EqMj9vMTNoaVhohnG3ZUSgDAwbiv+P084uLVy4uOtL0AAAWHL2WnpcUUGI3jrIgSIixMngkAH5zo2JqeEZNvm2KZocHxr4B7u3/44nBTSlLUwvO114t2r03fl0vXBK3JTaqflRIzf2LCOWWdZAbUSqme43y+hubeMyuWZebb7OyEddw5Eh+nTOW8fu5Sa98ees3sPQBAAkDmy/myBJ3mFVJIxmrT8n45uXPRZEL22nrW5YnmOJ9SJBQET0wyN272mj5sGZzaJ/ZxakKACJIkpGazo/1q1zC9+7X00ocmmkvXCA/c2+GD1caabSUNUY9O/X/FtpJLCRUNo9fqTDx/pHHs6s7jHRsBftr/FgA2fF6jK/yuZdV0uYdEmw80xKUmR1dkzIpdDAD9g+ZOh9N9mXF5Bjkv5wIPjSRYpJCGSBK1EfJnxizOP7e+GL30qaYAQNM04dbnvREbq1yrUsqyIjRyhUDwMI3jfDBb7Lf7ByynduYlv/efpoHx+t4/NOow9XK5TKQUUyK5h/MzrNvrYOx3B91XyLPl5fO90+n+Bnj1JdCPjO1wAAAAAElFTkSuQmCC" />
                  {{con.email}}</a>
              </td>
              <td><span style="font-weight: 900; text-transform: uppercase;">{{con.res_area.area_name}}</span></td>
              <td><span ng-if="con.status == 'PENDING'" class="badge bg-primary">{{con.status}}</span>
                <span ng-if="con.status == 'APPROVED'" class="badge bg-success">{{con.status}}</span>
                <span ng-if="con.status == 'REJECTED'" class="badge bg-warning">{{con.status}}</span>
              </td>
              <td>
                <span ng-if="myAccessType.can_edit_connections">
                  <button ng-if="con.status == 'PENDING'" type="button" class="btn btn-block btn-primary btn-xs">Approve</button>
                  <button ng-if="con.status == 'PENDING'" type="button" class="btn btn-block btn-warning btn-xs"
                    ng-click="setConnectionStatus(con.url, 'reject', con.email, con.passcode, con.push_id, con)">Reject</button>
                </span>
              </td>
            </tr>










          </tbody>
        </table>
        <!-- <a class="btn btn-block btn-default btn-xs" ng-click="loadMore()">More..</a> -->
      </div>
      <!-- /.card-body -->
    </div>
  </div>

</div>

<!-- Modal -->
<!-- <div class="modal fade" id="modal-sm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content">
      
      <div class="modal-body"> -->
<!-- <button type="button" class="btn btn-block btn-primary btn-xs">Change status</button> -->
<!-- <h4>{{activeConnection.name}}</h4> -->
<!-- <button ng-if="activeConnection.status == 'APPROVED' || activeConnection.status == 'REJECTED'" type="button" class="btn btn-block btn-primary btn-xs" ng-click="setConnectionStatus(activeConnection.url, 'reject', activeConnection.email, activeConnection.passcode)">Reject</button> -->
<!-- <button ng-if="activeConnection.status == 'PENDING' || activeConnection.status == 'REJECTED'" type="button" class="btn btn-block btn-primary btn-xs" ng-click="setConnectionStatus(activeConnection.url, 'approve', activeConnection.email, activeConnection.passcode)">Approve</button>
          <button type="button" class="btn btn-block btn-primary btn-xs" ng-click="setConnectionStatus(activeConnection.url, 'reject', activeConnection.email, activeConnection.passcode)">Reject</button>
      </div>
      
    </div>
  </div>
</div> -->

<div id="recurrConModal" class="modal fade" role="dialog">
  <rrule-recurring-select></rrule-recurring-select>
</div>



<!-- Resident edit Modal -->
<div id="viewConModal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-body">
        <div class="card card-widget widget-user-2">
          <div class="card card-secondary">
            <div class="card-header">
              <h3 class="card-title">Edit resident</h3>
            </div>
            <div class="card-body">
              <div class="form-group">
                <label>Name</label>
                <input type="text" ng-model="residentForModal.name" class="form-control formFields"
                  placeholder="Enter resident name">
              </div>
              <div class="form-group">
                <label>Phone</label>
                <input type="text" ng-model="residentForModal.phone" class="form-control formFields"
                  placeholder="Enter resident phone">
              </div>
              <div class="form-group">
                <label>Address</label>
                <textarea type="text" ng-model="residentForModal.address" class="form-control formFields"
                  placeholder="Enter resident address"></textarea>
              </div>
              <div class="form-group">
                <label>Email</label>
                <input type="text" ng-model="residentForModal.email" class="form-control formFields"
                  placeholder="Enter resident email">
              </div>

              <div class="form-group">
                <label>Number of resident</label>
                <input type="number" ng-model="residentForModal.number_of_resident" class="form-control formFields"
                  placeholder="Enter number of resident">
              </div>

              <div class="form-group">
                <label>Passport ID number</label>
                <input type="text" ng-model="residentForModal.id_passport_number" class="form-control formFields"
                  placeholder="Enter ID / passport number">
              </div>

              <div class="form-group">
                <label>Vehicle number</label>
                <tags-input id="tags" ng-model="currentVehicles">
                </tags-input>

              </div>

              <div class="form-group">
                <label>Select user area</label>
                <select class="custom-select" ng-model="residentForModal.residence_area">
                  <option ng-repeat="at in accountareas" value="{{at.area.url}}">{{at.area.area_name}}</option>
                </select>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="submit" class="btn btn-primary" ng-click="saveEditedResident(residentForModal)">Save
              resident</button>
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


<!-- Resident edit Modal -->
<div id="viewviewConModal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-body">
        <div class="card card-widget widget-user-2">
          <div class="card card-secondary">
            <div class="card-header">
              <h3 class="card-title">View resident</h3>
            </div>
            <div class="card-body">

              <ul class="nav flex-column">

                <li class="nav-item">
                  <a class="nav-link">
                    Visitor Name: <span class="float-right badge">{{residentForModal.name}}</span>
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link">
                    Visitor Phone: <span class="float-right badge">{{residentForModal.phone}}</span>
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link">
                    Address: <span class="float-right badge">{{residentForModal.address}}</span>
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link">
                    Email: <span class="float-right badge">{{residentForModal.email}}</span>
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link">
                    Passport / ID number: <span class="float-right badge">{{residentForModal.id_passport_number}}</span>
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link">
                    Number of residents: <span class="float-right badge">{{residentForModal.number_of_resident}}</span>
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link">
                    Vehicle: <span class="float-right badge">{{residentForModal.vehicle_number}}</span>
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link">
                    User location: <span class="float-right badge">{{residentForModal.res_area.area_name}}</span>
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link">
                    Passcode: <span class="float-right badge">{{residentForModal.passcode}}</span>
                  </a>
                </li>

              </ul>
            </div>
          </div>
          <div class="modal-footer">

            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>